<script>
    $(function () {
        var idProduct = null;

        $.ajax({
            url: "http://localhost:4000/api/lists/myLists", type: "POST",
            xhrFields: { withCredentials: true },
            crossDomain: true,
            success: function (data, status, request) {

                data.map(data => {
                    $("#ListasList").append(getListsList(data));

                })
                console.log(request.getAllResponseHeaders());
            }, error: function (res, errorStatus, error) { console.log(errorStatus) }
        })

        $(document).on("click", ".addProductToList", function (e) {
            idProduct = $(this).attr("id");
        })

        $(document).on("submit", "#formListProduct", function (e) {

            var form = $('#formListProduct').serializeArray();
            form.push({name:'id_product',value:idProduct})

            $.ajax({
                url: 'http://localhost:4000/api/listproducts/',
                data: form,
                type: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                xhrFields: {
                    withCredentials: true
                },
                dataType: "JSON",
                success: function (data) {
                    debugger
                    $("#AddList").modal("hide");

                    alert(data.status);
                },
                error: function (status) {
                    debugger
                    $("#AddList").modal("hide");
                    alert(status.responseJSON.status);
                }
            });
            e.preventDefault();

        })
    })
</script>

<div class="modal fade" id="AddProductList" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <form id="formListProduct">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Agregar producto a tu lista</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form action="#" method="POST">
                    <div class="modal-body">
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <div class="input-group-text align-middle">
                                    <label for="options">Â¿Lo tienes o lo buscas?</label>
                                </div>
                            </div>
                            <div class="btn-group btn-group-toggle w-100" data-toggle="buttons">
                                <label class="btn btn-secondary active">
                                    <input type="radio" value=true name="seTiene" id="option1" autocomplete="off"
                                        checked> Lo
                                    tengo
                                </label>
                                <label class="btn btn-secondary">
                                    <input type="radio" value=false name="seTiene" id="option2" autocomplete="off"> Lo
                                    busco
                                </label>
                            </div>
                        </div>


                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="ListasList">Listas</label>
                            </div>
                            <select class="custom-select" name="id_list" id="ListasList">
                            </select>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                        <input type="submit" name="submit" value="Enviar" class="btn btn-primary">
                    </div>
                </form>
        </div>
    </div>
</div>